/* Author: Drew Chase */
export default class ArrayInput extends HTMLElement{constructor(t,e,i){super(),this.option={name:this.getAttribute("name")||t||"",description:this.getAttribute("description")||e||"",default:(this.getAttribute("default")?this.getAttribute("default").split(","):i)||[],items:[]},this.$=$(this)}connectedCallback(){this.render()}addItem(t){this.option.items.push(t);let e=document.createElement("div");e.className="item",e.textContent=t,e.addEventListener("click",()=>{this.removeItem(e)}),this.textInput.value="",this.itemsContainer.appendChild(e),this.setAttribute("value",this.option.items.join(","))}removeItem(t){this.option.items.splice(this.option.items.indexOf(t),1),this.setAttribute("value",this.option.items.join(",")),t.remove()}render(){this.innerHTML=`\n            <div class="floating-input array-input row">\n                <div class='items row center vertical'></div>\n                <input type="text" placeholder="${this.option.description}" name="${this.option.name}" value="" class="fill">\n                <label for="${this.option.name}">${this.option.name}</label>\n                <div class="button"><i class="fa fa-add"></i></div>\n            </div>\n        `,this.button=this.querySelector(".button"),this.button.addEventListener("click",()=>{this.addItem(this.textInput.value)}),this.itemsContainer=this.querySelector(".items"),this.textInput=this.querySelector("input"),this.textInput.addEventListener("keydown",t=>{if("Enter"==t.key)t.preventDefault(),this.button.click();else if("Backspace"==t.key&&""==this.textInput.value){if(0==this.option.items.length)return;let t=this.option.items.pop();this.textInput.value=t,this.setAttribute("value",this.option.items.join(",")),this.itemsContainer.lastChild.remove()}}),this.setAttribute("value",this.option.default.join(",")),this.option.default.forEach(t=>{this.addItem(t)})}}customElements.define("array-input",ArrayInput);