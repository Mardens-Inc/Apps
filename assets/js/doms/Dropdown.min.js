/* Author: Drew Chase */
import DropdownOption from"./DropdownOption.js";export default class Dropdown extends HTMLElement{constructor(t,e=[]){if(super(),this.label=t,this.options=e,this.setAttribute("label",t),this.value=this.getAttribute("value"),this.$=$(this),0==this.$.find(".dropdown-items").length){const t=$("<div class='dropdown-items'></div>");t.append(this.options),this.$.append(t)}}connectedCallback(){this.setAttribute("tabindex","-1"),null==this.label&&0!=this.$.find(".name").length&&(this.label=this.$.find(".name").html()),null==this.label&&(this.label=this.getAttribute("label")),null!=this.label&&this.$.prepend(`<span class="name">${this.label}</span>`),null!=this.value&&this.setAttribute("value",this.value),this.options=this.$.find("dropdown-option"),0!=this.$.find("dropdown-option[selected]").length&&(this.selectedOption=this.$.find("dropdown-option[selected]")[0],this.selectOption(this.selectedOption)),0==this.$.find(".value").length?this.$.append($(`<span class="value">${null==this.selectedOption?"":this.selectedOption.label}</span>`)):this.$.find(".value").html(null==this.selectedOption?"":this.selectedOption.label),this.$.find("dropdown-option").on("click",t=>{this.selectOption(t.target),this.blur()})}addOption(t){this.options.push(t),this.appendChild(t)}removeOption(t){this.options.splice(this.options.indexOf(t),1),this.removeChild(t)}selectOption(t){this.value=t.value,this.setAttribute("value",t.value),this.$.find("dropdown-option").attr("selected",null),t.select(),0==this.$.find(".value").length?this.$.append($(`<span class="value">${t.label}</span>`)):this.$.find(".value").html(t.label),this.$.trigger("change",[{value:t.value}])}selectIndex(t){this.selectOption(this.options[t])}}customElements.define("drop-down",Dropdown);