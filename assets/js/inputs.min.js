/* Author: Drew Chase */
function handleUploadedFile(e,a){let t=new FileReader;t.readAsDataURL(e),t.onload=(()=>{a.removeClass("dragover");let l=atob(t.result.split(";base64,").pop());a.trigger("upload",[{name:e.name,content:l,file:e}])})}function startLoading(){$("body").append('<div class="loading-body"><div class="loading"></div></div>')}function stopLoading(){$("body .loading-body").remove()}$(".drag-drop-area").on("dragover",e=>{let a=$(e.target);e.preventDefault(),e.stopPropagation(),a.addClass("dragover")}),$(".drag-drop-area").on("dragleave",e=>{let a=$(e.target);e.preventDefault(),e.stopPropagation(),a.removeClass("dragover")}),$(".drag-drop-area").on("drop",e=>{let a=$(e.target);e.preventDefault(),e.stopPropagation(),a.removeClass("dragover"),handleUploadedFile(e.originalEvent.dataTransfer.files[0],a)}),$(".drag-drop-area").on("click",e=>{let a=$(e.currentTarget),t=$(`<input type="file" accept="${a.attr("accept").replace(/\*/g,"")}">`);t.trigger("click"),t.on("change",()=>{handleUploadedFile(t.prop("files")[0],a)})}),$(".drag-drop-area").each((e,a)=>{let t=$(a),l=t.attr("accept");t.html(`<i>(${l})</i>`)}),$("toggle").on("click",e=>{e.preventDefault();let a=$(e.target),t="true"===a.attr("value");a.attr("value",!t),a.trigger("toggle",[{value:!t}])}),$(document).ready(()=>{$("select").each((e,a)=>{let t=$(a),l=t.find("option"),r=null==t.attr("name")?"":t.attr("name"),d=null==t.attr("id")?"":t.attr("id"),o=null==t.attr("class")?"":t.attr("class"),n=t.find("option[select]"),i=$(`<dropdown id="${d}" class="${o}" tabindex="-1"><div class="name">${r}</div><div class="value"></div></dropdown>`),s=$("<dropdown-items></dropdown-items>");i.append(s),i.attr("value",n.attr("value")),i.find(".value").html(n.html()),l.each((e,a)=>{let t=$(`<dropdown-item value="${$(a).attr("value")}">${$(a).html()}</dropdown-item>`);t.on("click",e=>{let a=$(e.target),t=a.parent().parent();a.hasClass("selected")?(a.removeClass("selected"),t.attr("value",null),t.find(".value").html("")):(t.find("dropdown-item.selected").removeClass("selected"),a.addClass("selected"),t.attr("value",a.attr("value")),t.find(".value").html(a.html())),t.trigger("change",[{value:a.attr("value")}]),t.blur()}),s.append(t),null!=$(a).attr("select")&&(t.addClass("selected"),$(document).on("dropdowns-loaded",()=>{i.trigger("change",[{value:t.attr("value")}])}))}),t.replaceWith(i),$(document).trigger("dropdowns-loaded")})});