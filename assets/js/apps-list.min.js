/* Author: Drew Chase */
async function buildAddAppOptionsFromTemplate(e){const t=await getTemplateJson(e),a=$("dialog#add-item-modal #template-options");a.html(""),a.append($(`<h2>${t.name}</h2>`)),a.append($(`<p style="text-align: center; font-size: 1.5rem; margin-top: 10px; margin-bottom: 1rem;">${t.description}</p>`));for(const e of t.options){const n=e.name.toLowerCase().replace(/[^a-z]/g,"-");let o;switch(console.log(n),e.type){case"select":const i=e.options.map(t=>new DropdownOption(t.name,t.value,t.value==e.default)),l=new Dropdown(e.name,i);l.title=e.description,a.append(l);break;case"boolean":(o=new Toggle(e.name,e.default)).title=e.description;const p=t.options.filter(t=>t.condition&&t.condition==e.name),d=e=>{e?p.forEach(e=>{const t=e.element;t&&t.css("display","block")}):p.forEach(e=>{const t=e.element;t&&t.css("display","none")})};$(o).on("toggle",(e,t)=>{d(t.value)}),$(document).on("finish-building-options",()=>{d(o.value)});break;case"text":o=$(`<div class="floating-input col" id="${n}"></div>`);const r=$(`<label for="${e.name}">${e.name}</label>`),s=$(`<input type="text" placeholder="${e.description}" name="${e.name}" value="${e.default}">`);s.title=e.description,o.append(s),o.append(r);break;case"number":o=$('<div class="floating-input col"></div>');const c=$(`<label for="${e.name}">${e.name}</label>`),m=$(`<input type="number" placeholder="${e.description}" name="${e.name}" value="${e.default}">`);m.title=e.description,o.append(m),o.append(c);break;case"color":o=$('<div class="color-input center vertical row"></div>');const u=$(`<label for="${e.name}" class='fill'>${e.name}</label>`),f=$(`<input type="color" placeholder="${e.description}" name="${e.name}" value="${e.default}">`);o.attr("title",e.description),o.append(u),o.append(f);break;case"date":o=$('<div class="floating-input col"></div>');const b=$(`<label for="${e.name}">${e.name}</label>`),g=$(`<input type="date" placeholder="${e.description}" name="${e.name}" value="${e.default}">`);g.title=e.description,o.append(g),o.append(b);break;case"time":o=$('<div class="floating-input col"></div>');const v=$(`<label for="${e.name}">${e.name}</label>`),y=$(`<input type="time" placeholder="${e.description}" name="${e.name}" value="${e.default}">`);y.title=e.description,o.append(y),o.append(v);break;case"datetime":o=$('<div class="floating-input col"></div>');const w=$(`<label for="${e.name}">${e.name}</label>`),h=$(`<input type="datetime-local" placeholder="${e.description}" name="${e.name}" value="${e.default}">`);h.title=e.description,o.append(h),o.append(w);break;case"textarea":o=$('<div class="floating-input col"></div>');const k=$(`<label for="${e.name}">${e.name}</label>`),x=$(`<textarea type="text" placeholder="${e.description}" name="${e.name}">${e.default}</textarea>`);x.title=e.description,o.append(x),o.append(k);break;case"file":o=$(`<file-input name="${e.name}" description="${e.description}" extensions="${e.extensions.join(",")}" multiple="${e.multiple}" default="${e.default}"></file-input>`);break;case"array":o=$(`<array-input name="${e.name}" description="${e.description}" default="${e.default.join(",")}"></array-input>`)}e.element=o,a.append(o)}a.append($("<div class='row center vertical fill' style='margin-top: 1rem;'><button id='add-item' type='submit' style='margin: auto;width: 200px;'>Add</button></div>")),$(document).trigger("finish-building-options")}async function getTemplateJson(e){return await $.ajax({url:`/templates/${e}/template.json`,method:"GET",dataType:"json",beforeSend:()=>{startLoading()},complete:()=>{stopLoading()},success:e=>e,error:(e,t,a)=>(console.log(a),alert(`Error: ${a}`),null)})}import Dropdown from"./doms/Dropdown.js";import Toggle from"./doms/Toggle.js";import DropdownOption from"./doms/DropdownOption.js";import ArrayInput from"./doms/ArrayItem.js";import FileInput from"./doms/FileInput.js";$("dialog#add-item-modal drop-down#template").on("change",(e,t)=>{buildAddAppOptionsFromTemplate(t.value)}),$("dialog#add-item-modal drop-down#template dropdown-option")[1].click();